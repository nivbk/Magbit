<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Verifying ReturnUrl Signatures using Signature Version 2</title>
  <style type="text/css">
    body, div, p, td, th {
      font-family : helvetica,sans-serif, arial;
      font-size : 12px;
      color : #000000;
    }

    .aws-h1, h1{
      font-family: verdana, arial, helvetica, sans-serif;
      font-size: 18px;
      font-weight: bold;
      color: #000000;
    }
    .aws-h2, h2{
      font-family: verdana, arial, helvetica, sans-serif;
      font-size: 14px;
      color: #c60;
    }
    .aws-h3, h3{
      font-family: verdana, arial, helvetica, sans-serif;
      font-size: 12px;
      font-weight: bold;
      color: #333333;
    }

    /*table ID selector styles*/
    #aws-table {
      border-top: 1px solid #cccccc;
      border-left: 1px solid #cccccc;
      width:95%;
    }

    #aws-table td{
      font-size: 12px;
      padding: 5px 5px 5px 5px;
      border-bottom: 1px solid #cccccc;
      border-right: 1px solid #cccccc;
      vertical-align:top;
    }

    #aws-table th {
      font-size: 12px;
      padding: 5px 5px 5px 5px;
      border-bottom: 1px solid #cccccc;
      border-right: 1px solid #cccccc;
      vertical-align:top;
      background-color: #eeeeee;
      color: #333333;
      font-size: 12px;
      font-weight: bold;
      text-align: left;
    }

    /*code, note, and example styles*/
    pre {
      font-family: "Courier New", Courier, mono;
      font-size: 12px;
      margin-top: 5px;
      margin-bottom: 5px;
      color: #000066;
      padding: 5px;
      background-color: #eff7ff;
      border: 1px dashed #333;
      width:75%;
      display:block;
    }

  </style>
</head>

<body>

<h2>Examples of ReturnUrl redirect requests signed with signature version 2</h2>

<p>This section includes examples to help you understand how to form the string
to sign with signature version 2. New lines have been inserted to make the
examples easier to read. Explicit '\n' is used wherever new line is required.</p>

<p>Example return url redirection request by ASP signed using signature version 2:</p>
<pre>
    Return URL : http://yourwebsite.com/return.jsp
    Parameters sent by ASP in ReturnUrl (using HTTP GET):
	paymentReason = Test Widget
	transactionDate = 1254987247
	buyerName = test sender
	recipientEmail = test-recipient@amazon.com
	referenceId = test-reference123
	paymentMethod = Credit Card
	operation = pay
	signatureMethod = RSA-SHA1
	signature = VirmnCtqA/A+s+H+SE7Oj8Ku7Lfay6OKkJgP/Q0hyQeaR6evI8Usokg698utW6xzJsiUudXm0KpmqiWM33o1aby3AOxZ
	qWUC//aMZPO9vdw1NWR5fOJ++8AR9BAfcUtTHWc2QOHa1UyJalqeMsHuQj2IqQCMmOAUHPFkHhwAZMS9Ifkkxjqczg4S0vK9FoO39rFY
	kReYdL9SvuFyj6byAnqd3D7i/lgw+6jXjAlM9MqYiisMLyCGk0IQsrux5VbiQgI9LiGqUThGh7o2XkEFWvmPlKFmdQVnLxN9RNOK4pwr
	ktbjgrBfVKZu1BBBXjfwwy9xzin0Kw5uNlCD2ReoZA==
	buyerEmail = test-sender@amazon.com
	transactionAmount = USD 1.1
	status = PS
	recipientName = Test Business
	transactionId = 14GPH3CZ83RPQ1ZH6J2G85NL1IO3KO8641R
	signatureVersion = 2
	certificateUrl = https://fps.sandbox.amazonaws.com/certs/090909/PKICert.pem
</pre>

<p>String to sign in signature version 2:</p>
<pre>
	GET\n
	yourwebsite.com\n
	/return.jsp\n
	buyerEmail=test-sender%40amazon.com&
	buyerName=test%20sender&
	certificateUrl=https%3A%2F%2Ffps.sandbox.amazonaws.com%2Fcerts%2F090909%2FPKICert.pem&
	operation=pay&
	paymentMethod=Credit%20Card&
	paymentReason=Test%20Widget&
	recipientEmail=test-recipient%40amazon.com&
	recipientName=Test%20Business&
	referenceId=test-reference123&
	signatureMethod=RSA-SHA1&
	signatureVersion=2&
	status=PS&
	transactionAmount=USD%201.1&
	transactionDate=1254987247&
	transactionId=14GPH3CZ83RPQ1ZH6J2G85NL1IO3KO8641R
</pre>

</body>
</html>
